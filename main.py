# This is a sample Python script.

# Press Shift+F10 to execute it or replace it with your code.
# Press Double Shift to search everywhere for classes, files, tool windows, actions, and settings.


def print_hi(name):
    # Use a breakpoint in the code line below to debug your script.
    print(f'Hi, {name}')  # Press Ctrl+F8 to toggle the breakpoint.


import asyncio
import json
import pandas as pd
import aiobotocore as aiobotocore
from loguru import logger


async def publish_to_sqs():
    logger.info(f" initiating SQS")
    session = aiobotocore.get_session()
    sqs_client = await session._create_client(
        "sqs",
        region_name="ap-south-1",
        endpoint_url="http://localhost:4566",
    )
    logger.info(f" connection SQS  started")

    response = await sqs_client.send_message(
        QueueUrl="http://localhost:4566/000000000000/test_queue",
        # MessageBody=json.dumps([{"doc":{"catalogVersion":"Online","tesg_string":232,"code_string":"MP000000006490615","colour_string_mv":123,"testing_string_mv":["Multicolor_multicolor", 123.5],"testing2_mv":[123.5, 232],"name_text_en":"AMZER Back Cover for Honor 20/20 Pro-Unification Arch- South Korea flag","categoryPath_string_mv":["/MPH1/MPH12","/MPH1","/BSH1/BSH1E00443/BSH1E00443MSH12/BSH1E00443MSH1222/BSH1E00443MSH1222101","/MSH1","/MBH1/MBH12/MBH12E00443","/MSH1/MSH12/MSH1222","/MPH1/MPH12/MPH1218/MPH1218101","/MPH1/MPH12/MPH1218/MPH1218101/MPH1218101101","/BSH1/BSH1E00443/BSH1E00443MSH12/BSH1E00443MSH1222","/MSH1/MSH12","/MBH1","/MSH1/MSH12/MSH1222/MSH1222101","/BSH1/BSH1E00443","/BSH1/BSH1E00443/BSH1E00443MSH12","/BSH1","/MBH1/MBH12","/MPH1/MPH12/MPH1218"],"exchangeAvailableFilter_boolean":False,"onlineExclusive_boolean":False,"indexeropn":"FULL","allCategories_string_mv":["BSH1E00443MSH12","BSH1","MSH1222","BSH1E00443MSH1222101","BSH1E00443MSH1222","MSH12","BSH1E00443","MSH1222101","MBH12E00443"],"categoryNameCodeMapping_en_string_mv":["BSH1E00443MSH12|Electronics","BSH1|Primary Brand Sales","MSH1222|Accessories","BSH1E00443MSH1222101|Covers & Cases","BSH1E00443MSH1222|Accessories","MSH12|Electronics","BSH1E00443|AMZER","MSH1222101|Covers & Cases","MBH12E00443|AMZER"],"brand_en_string_mv":["MBH12E00443"],"snsCategory_string_mv":["MSH1222"],"reviewCount_int":0,"id":"mplProductCatalog/Online/MP000000006490615","isOffersExisting_boolean":False,"mrpPriceValue_inr_double":799,"brandName_text_en_mv":["AMZER"],"ratingReviewVisibility_boolean":False,"img-252Wx374H_string":"//img.tatacliq.com/images/i6/252Wx374H/MP000000006490615_252Wx374H_20200209051247.jpeg","deptType_string_mv":["Electronics"],"relevancescore_int":0,"maxExchangeBumpUp_double":0,"departments_string_mv":["MSH12"],"ussID_string_mv":["100144601040995630:799.0:399.0:0"],"exchangeOfferTag_boolean":False,"isVariant_boolean":False,"caseOrCover-classification_en_string_mv":["Back Cover"],"isDiscountedPrice_double":50.06257822277847,"exchangeAvailableTag_boolean":False,"mobileprice_inr_double":399,"discountAll_string":"Discounted Items","newTitle_string_mv":["AMZER Back Cover for Honor 20/20 Pro Multicolor-Unification Arch- South Korea flag 360641361234"],"promotedProduct_boolean":False,"isLuxuryProduct_boolean":False,"partialv2timestamp":"2021-07-21T00:59:50.320Z","catalogId":"mplProductCatalog","categoryName_text_en_mv":["Accessories","Electronics","Covers & Cases"],"baseProductColourGroup_string":"MP000000006490615","cutSizeFlag_boolean":False,"keywords_shingle_text_en_mv":["AMZER","AMZER Back Cover for Honor 20/20 Pro-Unification Arch- South Korea flag","Accessories","Electronics","Covers & Cases"],"url_en_string":"/amzer-slim-designer-printed-light-weight-back-cover-for-honor-20-20-pro--unification-arch-south-korea-flag/p-mp000000006490615","priceValue_inr_double":399,"productCategoryType_string":"Electronics","inStockFlag_boolean":False,"showExchangeTag_boolean":False,"name_sortable_en_sortabletext":"AMZER Back Cover for Honor 20/20 Pro-Unification Arch- South Korea flag","maxExchangePrice_double":0,"timestamp":"2021-07-21T00:59:50.320Z","discountFlag_en_string":"50% - 70%","immediateCategory_string":"MSH1222101","sellerId_string_mv":["100144"],"mplRatingCount_int":0,"features-classification_en_string_mv":["Designer Case for Honor 20/20 Pro is made for definitive fit for maximum protection","Honor 20/20 Pro Slim Protective Case is Ultra thin case protects your device from everyday wear and tear","Shockproof Back Cover for your Honor 20/20 Pro is ultra light yet ultra strong polymer hard case to protect against shocks","Slim protective case is trendy and impressive designed case for your Honor 20/20 Pro"],"price_inr_string":"₹0-₹1,000","indexOperationId":106614544978934290,"img-437Wx649H_string":"//img.tatacliq.com/images/i6/437Wx649H/MP000000006490615_437Wx649H_20200209051247.jpeg","title_text_en":"AMZER Slim Designer Printed Light Weight Back Cover for Honor 20/20 Pro - Unification Arch- South Korea flag","category_en_string_mv":["MSH1222","MSH12","MSH1222101"],"itemtype_string":"Product","_version_":1705833283622797300,"promotedProductPriority_int":0,"mobileBrandName_string":"AMZER","departmentHierarchy_string_mv":["|MSH1:Sales:L0:false:0","|MSH1:Sales:L0:false:0|MSH12:Electronics:L1:true:0|MSH1222:Accessories:L2:false:0|MSH1222101:Covers & Cases:L3:false:0","|MSH1:Sales:L0:false:0|MSH12:Electronics:L1:true:0|MSH1222:Accessories:L2:false:0","|MSH1:Sales:L0:false:0|MSH12:Electronics:L1:true:0"],"warranty-classification_en_string_mv":["NA"],"keywords_text_en":"","leastSizeProduct_string":"MP000000006490615","pk":9036848037889,"stockLevelStatus_boolean":False,"micrositeSnsCategory_string_mv":["BSH1E00443MSH1222"],"suitableFor-classification_en_string_mv":["Honor 20/20 Pro"]}}]),
        MessageBody=json.dumps([{"doc":{"catalogVersion":"Online","code_string":"MP000000001247836","colour_string_mv":["Navy_000080"],"name_text_en":"Red Tape Navy Walking Shoes","categoryPath_string_mv":["/MPH1","/MPH1/MPH13","/MBH1/MBH13/MBH13F00070","/BSH1/BSH1F00070/BSH1F00070MSH13/BSH1F00070MSH1311","/BSH1/BSH1F00070/BSH1F00070MSH13/BSH1F00070MSH1311/BSH1F00070MSH1311128","/BSH1/BSH1F00070/BSH1F00070MSH13/BSH1F00070MSH1311/BSH1F00070MSH1311128/BSH1F00070MSH1311128100","/MSH1","/MSH1/MSH13/MSH1311/MSH1311128","/MSH1/MSH13/MSH1311","/MPH1/MPH13/MPH1311/MPH1311103","/MPH1/MPH13/MPH1311/MPH1311103/MPH1311103100","/BSH1/BSH1F00070","/BSH1/BSH1F00070/BSH1F00070MSH13","/MSH1/MSH13","/MBH1","/MSH1/MSH13/MSH1311/MSH1311128/MSH1311128100","/BSH1","/MBH1/MBH13","/MPH1/MPH13/MPH1311"],"onlineExclusive_boolean":False,"indexeropn":"UPDATE","allCategories_string_mv":["MBH13F00070","MSH13","BSH1F00070MSH1311","BSH1F00070MSH13","BSH1","MSH1311128100","MSH1311128","BSH1F00070MSH1311128","BSH1F00070","BSH1F00070MSH1311128100","MSH1311"],"categoryNameCodeMapping_en_string_mv":["MBH13F00070|Red Tape","MSH13|Footwear","BSH1F00070MSH1311|Men","BSH1F00070MSH13|Footwear","BSH1|Primary Brand Sales","MSH1311128100|Running","MSH1311128|Sports Shoes","BSH1F00070MSH1311128|Sports Shoes","BSH1F00070|Red Tape","BSH1F00070MSH1311128100|Running","MSH1311|Men"],"displaySize_string_mv":["UK/IND-10","UK/IND-11","UK/IND-12","UK/IND-6","UK/IND-7","UK/IND-8","UK/IND-9"],"brand_en_string_mv":["MBH13F00070"],"snsCategory_string_mv":["MSH1311128"],"reviewCount_int":0,"id":"mplProductCatalog/Online/MP000000006312323","collectionIds_string_mv":[],"isOffersExisting_boolean":False,"tipshape-classification_en_string_mv":["Round"],"swatchColor_string_mv":["Black_000000||MP000000006312326"],"mrpPriceValue_inr_double":6995.0,"displayUrl_string_mv":["[{\"UK\\/IND-10\":\"\\/red-tape-navy-walking-shoes\\/p-mp000000006310485\"},{\"UK\\/IND-7\":\"\\/red-tape-navy-walking-shoes\\/p-mp000000006312085\"},{\"UK\\/IND-6\":\"\\/red-tape-navy-walking-shoes\\/p-mp000000006312103\"},{\"UK\\/IND-9\":\"\\/red-tape-navy-walking-shoes\\/p-mp000000006312105\"},{\"UK\\/IND-11\":\"\\/red-tape-navy-walking-shoes\\/p-mp000000006312323\"},{\"UK\\/IND-8\":\"\\/red-tape-navy-walking-shoes\\/p-mp000000006312324\"},{\"UK\\/IND-12\":\"\\/red-tape-navy-walking-shoes\\/p-mp000000006312327\"}]"],"brandName_text_en_mv":["Red Tape"],"ratingReviewVisibility_boolean":True,"img-252Wx374H_string":"//imgpreprod4.tataunistore.com/images/i6/252Wx374H/MP000000006310485_252Wx374H_20200114203510.jpeg","deptType_string_mv":["Footwear"],"relevancescore_int":1508,"mplAvgRating_double":5.0,"departments_string_mv":["MSH13"],"spellcheck_en":["Red Tape Navy Walking Shoes",""],"ussID_string_mv":["100213RSO0194D11:6995.0:2098.0:1030"],"isVariant_boolean":True,"isDiscountedPrice_double":70.00714796283059,"spellcheck":["BSH1F00070MSH1311128","MP000000006312323","MSH1311128"],"sizetype-classification_en_string_mv":["UK/IND"],"solematerial-classification_en_string_mv":["EVA"],"mobileprice_inr_double":2098.0,"autosuggest_en":"Red Tape Navy Walking Shoes","discountAll_string":"Discounted Items","deliveryMode_string_mv":["standard delivery"],"displayStock_string_mv":["[{\"UK\\/IND-10\":\"inStock\"},{\"UK\\/IND-7\":\"inStock\"},{\"UK\\/IND-6\":\"inStock\"},{\"UK\\/IND-9\":\"inStock\"},{\"UK\\/IND-11\":\"inStock\"},{\"UK\\/IND-8\":\"inStock\"},{\"UK\\/IND-12\":\"outOfStock\"}]"],"newTitle_string_mv":["Red Tape Navy Walking Shoes 360641361234"],"promotedProduct_boolean":False,"isLuxuryProduct_boolean":False,"catalogId":"mplProductCatalog","categoryName_text_en_mv":["Footwear","Running","Sports Shoes","Men"],"baseProductColourGroup_string":"navy9030904545281","cutSizeFlag_boolean":True,"url_en_string":"/red-tape-navy-walking-shoes/p-mp000000006312323","priceValue_inr_double":2098.0,"productCategoryType_string":"Footwear","inStockFlag_boolean":True,"name_sortable_en_sortabletext":"Red Tape Navy Walking Shoes","discountFlag_en_string":"70% and more","size_string_mv":["UK/IND-11"],"immediateCategory_string":"MSH1311128100","sellerId_string_mv":["100213"],"displayMrpPrice_string_mv":["[{\"UK\\/IND-10\":6995.0},{\"UK\\/IND-7\":6995.0},{\"UK\\/IND-6\":6995.0},{\"UK\\/IND-9\":6995.0},{\"UK\\/IND-11\":6995.0},{\"UK\\/IND-8\":6995.0},{\"UK\\/IND-12\":6995.0}]"],"mplRatingCount_int":3,"price_inr_string":"₹2,001-₹5,000","indexOperationId":108152334562459650,"img-437Wx649H_string":"//imgpreprod4.tataunistore.com/images/i6/437Wx649H/MP000000006310485_437Wx649H_20200114203510.jpeg","title_text_en":"Red Tape Navy Walking Shoes","category_en_string_mv":["MSH13","MSH1311128100","MSH1311128","MSH1311"],"itemtype_string":"PcmProductVariant","displayPrice_string_mv":["[{\"UK\\/IND-10\":2098.0},{\"UK\\/IND-7\":2098.0},{\"UK\\/IND-6\":2098.0},{\"UK\\/IND-9\":2098.0},{\"UK\\/IND-11\":2098.0},{\"UK\\/IND-8\":2098.0},{\"UK\\/IND-12\":2098.0}]"],"promotedProductPriority_int":0,"mobileBrandName_string":"Red Tape","departmentHierarchy_string_mv":["|MSH1:Sales:L0:false:0|MSH13:Footwear:L1:true:0|MSH1311:Men:L2:false:0|MSH1311128:Sports Shoes:L3:false:0|MSH1311128100:Running:L4:false:0","|MSH1:Sales:L0:false:0|MSH13:Footwear:L1:true:0|MSH1311:Men:L2:false:0|MSH1311128:Sports Shoes:L3:false:0","|MSH1:Sales:L0:false:0","|MSH1:Sales:L0:false:0|MSH13:Footwear:L1:true:0|MSH1311:Men:L2:false:0","|MSH1:Sales:L0:false:0|MSH13:Footwear:L1:true:0"],"searchCapacity_string_mv":[],"keywords_text_en":"","leastSizeProduct_string":"MP000000006312323","pk":9030975062017,"stockLevelStatus_boolean":True,"micrositeSnsCategory_string_mv":["BSH1F00070MSH1311128"]}}]),
        # MessageBody=json.dumps([{'_id':'search-bat','facets':[{'count': '32', 'name': 'instockflag', 'order': '1'}, {'count': '15', 'name': 'price', 'order': '2'}, {'count': '12', 'name': 'category', 'order': '3'}, {'count': '4', 'name': 'discountflag', 'order': '4'}, {'count': '2', 'name': 'size', 'order': '5'}, {'count': '2', 'name': 'discountall', 'order': '6'}, {'count': '2', 'name': 'ram-classification', 'order': '7'}, {'count': '1', 'name': 'fastening-classification', 'order': '8'}]}]),
        MessageAttributes={"Operationtype": {"StringValue": "UPDATE", "DataType": "String"}}
    )
    print(response)

if __name__ == "__main__":
    loop = asyncio.get_event_loop()
    loop.run_until_complete(publish_to_sqs())

